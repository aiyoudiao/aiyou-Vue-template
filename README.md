# aiyou-Vue-template
基于过往项目提取出一个Vue的模板，之后每次都使用这个模板来进行Vue方面的开发，如果以后发现更好的，再拿过来改改。

做这个开源项目，目前分三个阶段目标。

## 第一阶段

搭建基本架构，完成模块开发，如用户管理、角色管理、菜单管理(权限管理)

### 基本架构设计

1. 在vue.config.js中将src目录及目录下的每个文件夹都resolve一个alias，方便模块引入
2. 创建constant目录，用来存储一些常量，这样就能减少编写字符串时的错误概率，因为直接写字符串，很难报错，肉眼难以识别。
3. 在router、store、views、constant中，根据模块来创建相应的目录，先是父级目录，再是子级目录，这样便于维护。
4. 在common目录下创建 http 目录，用来存取所有请求方法，在common目录下创建 urls 目录，用来存取所有请求路径，在common目录下创建 validator 目录，用来存取所有验证方法。在common目录下创建 utils 目录，用来存取一些实用的工具方法。
5. 在src目录下，创建permission目录，用来给前端控制权限，会在mian.js中引入，优先级很高。
6. 在src目录下，创建components 目录，用来存放一些公共组件或者公共视图。
7. 在src目录下，创建assets 目录，用来存放一些vue文件引入的静态资源文件。

### 技术栈设计

1. 采用iview + Vue全家桶
2. 使用plop 来完成常用代码的自动生成
3. 使用jest来进行单元测试
4. 使用eslint 来控制代码规范

### 模块设计

- 系统管理
  - 用户管理
  - 角色管理
  - 菜单管理

### 字段设计
 
#### 用户管理

用户ID，`用户名称`，`用户手机`，`用户邮箱`，`用户权限`，操作创建的人，操作创建的时间，变更操作的人，变更操作的时间，用户备注，用户状态

#### 角色管理

角色ID，角色名称，角色权限代码，操作创建的人，操作创建的时间，变更操作的人，变更操作的时间，角色备注，角色状态。

#### 菜单管理

菜单列表（树结构）：菜单ID，菜单名称，菜单关键字，是否隐藏，菜单图标，图标大小，角标，菜单备注，子菜单列表。  
菜单详情：除了菜单列表中的数据之外，添加一个permission字段，例如`["insert, delete, update, detail"]`  
菜单详情扩展：为了给后端控制权限，添加一个接口列表，interface，主要是让后端控制它后端能否访问该接口，暂时不管它。  
角色列表：角色管理上面的所有字段，点击某个角色，渲染某个角色的菜单列表(树结构)。  

#### 权限控制设计

权限分两种：一种是该页面的访问权限，一种是该页面的操作权限及可见性。通过vuex + router的异步组件来实现页面访问权限。通过vuex + 页面的逻辑判断来实现按钮操作的权限及可见性。

1. 在登陆页面，登录成功之后，获取用户权限菜单，然后将菜单数据填充到vuex中，就会根据这些菜单渲染首页的菜单列表。如果不是从登录页面跳转过来的，那么在首页这里进行请求发送，获取当前用户的权限菜单数据，然后根据这些权限菜单数据来渲染左侧的菜单列表。每隔三十分钟，会自动发送获取菜单权限数据的请求，然后自动更新到vuex中去，保持权限能够同步更新。
2. 所有菜单项都会再首页列表中再进行深度优先遍历渲染出来，只要菜单没有设置hidden为true，就能够显示出来。在代码中，会将所有异步组件都注册进去，每个异步组件都一个key，而这个key对应了菜单列表中的name。通过深度优先遍历的方式，给指定name的菜单注册一个路由，从而可以通过点击该路由而跳转至某个页面。`先渲染菜单，再给菜单注册路由`，未注册路由的菜单，点击之后不会具备任何页面跳转的行为。注意，所有的异步组件对应的key，必须要在`src/constant`目录下使用常量声明，注意命名规范，避免命名冲突而导致意外状况发生。在`src/constant`中声明的异步组件对应的key常量，也可以作为菜单列表中的name来使用，这样就让异步router和vuex中的menuList中的menu的name统一了起来，也不容易出错。
3. 写一个全局方法，可以根据当前页面的name，来获取到菜单中该组件的permission，这个权限的作业会将页面中的操作控制到按钮级别。`permission：["insert, delete, update, detail"]` ，得到该页面拥有哪些权限，会在mount生命周期中，给data设置是否拥有操作该按钮权限，从而控制页面中是否能够显示该按钮。
4. 如果菜单列表中不存在的页面，你访问时该页面地址会自动跳转到404去，因为之前根据菜单绑定异步组件时，添加没有该页面的路由，所以当路由列表中不存在该页面地址时，就会跳到404。


## 第二阶段

完成Vue的webpack相关配置，可以直接使用webpack来开发、生产这个Vue项目

## 第三阶段

寻找iview相关的开源项目，收集并整理。
将那些开源组件的封装的相关组件放入这个框架中，以便后续使用。

